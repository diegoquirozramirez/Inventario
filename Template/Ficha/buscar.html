
{% extends 'index.html' %}
{% block content %}  
<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>

  <link rel="stylesheet" href="http://code.jquery.com/ui/1.8.18/themes/base/jquery-ui.css" type="text/css" media="all" /> <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"> </script> <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
    
<div class="app-main">             
    <div class="app-main__outer" style="margin-left: -270px;">
        
                        <div class="app-main__inner">
                                <div class="row">
                                        <div class="col-lg-12" style="margin-top: -70px;">
                                                <div class="page-title-subheading col-lg-12">
                                                        {% if messages %}
                                                        <div class="messages alert alert-danger form-control col-lg-12" role="alert" style="height: 50px;">
                                                            {% for message in messages %}
                                                            <center>
                                                            <p {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
                                                            </center>
                                                            {% endfor %}
                                                        </div>
                                                    {% endif %}
                                                </div>
                                        </div>
                                    </div>
                               
                            <div class="row">
                                
                                    <div class="col-lg-12" style="width: 10px;">
                                        <div class="main-card mb-3 card" style="width: 25%; margin-top: -30px;">
                                            <div class="card-body">
                                                
                                                <table class="mb-0 table table-bordered" >
                                                        <div class="search-wrapper">
                                                            
                                                                <!--div class="input-holder">
                                                                      
                                                                        <input type="text" id="num_ficha" name="num_ficha" class="search-input" placeholder="Type to search">
                                                                   
                                                                    
                                                                    <button class="search-icon" id="btn_save" ><span> </span></button>
                                                                </div>
                                                                <button class="close"></button-->
                                                            <form action="{% url 'consultar-ficha' %}">
                                                                    <div class="form-row">
                                                                            <div class="col-12">
                                                                                <input type="text" id="num_ficha" name="num_ficha" placeholder="Número de Ficha" class="form-control" maxlength="9"  />
                                                                        </div>
                                                                      
                                                                        <script>

                                                                            $(function() {
                                                                            $("#num_ficha").autocomplete({
                                                                            source: "/ficha/get-ficha/",
                                                                            select: function (event, ui) { //item selected
                                                                                AutoCompleteSelectHandler(event, ui)
                                                                            },
                                                                            minLength: 2,
                                                                            });
                                                                            });
                                                                            
                                                                            function AutoCompleteSelectHandler(event, ui)
                                                                            {
                                                                            var selectedObj = ui.item;
                                                                            }
                                                                            
                                                                            </script>
                                                                        </div>
                                                                        <div class="form-row">
                                                                            <div class="col-12">
                                                                                
                                                                                <input type="submit"  id="ficha" value="Consultar" class="form-control btn btn-primary" style="margin-top: 15px;">
                                                                            </div>
                                                                    </div>
                                                            </form>
                                                            
                                                            <!--div class="search-wrapper">
                                                                    <div class="input-holder">
                                                                        <input type="text" class="search-input" placeholder="Type to search">
                                                                        <button class="search-icon" ><span></span></button>
                                                                    </div>
                                                                    <button class="close"></button>
                                                            </div-->
                                                                <!--script type="text/javascript">
                                                                  
                                                                    /**function on_click(){
                                                                        var num_ficha = document.getElementById('num_ficha').value;
                                                                        console.log(num_ficha)
                                                                    }*/
                                                               

                                                                    $(function() {

                                                                        $('#ficha').on('click', function() {
                                                                            var num_ficha = document.getElementById('num_ficha').value;
                                                                            $.get("{% url 'consultar-ficha' %}", {
                                                                                "ficha": num_ficha,
                                                                               
                                                                            },function(data) {
                                                                                var html = "";
                                                                                
                                                                                for (var i = 0; i< data.length; i++){
                                                                                    html +='<thead>'+
                                                                                        '<tr>'+
                                                                                            '<th colspan="">Número de Ficha</th>'+
                                                                                            '<th colspan="">Fecha de Creación</th>'+
                                                                                            '<th colspan="">Ambiente</th>'+
                                                                                            '<th colspan="">Piso</th>'+
                                                                                            '<th colspan="">Dependencia</th>'+
                                                                                            '<th colspan="">Sede</th>'+
                                                                                            '<th colspan="2">Acciones</th>'+
                                                                                      
                                                                                        '</tr>'+
                                                                                    '</thead>'+
                                                                                    '<tbody>'+
                                                                                        '<tr>'+
                                                                                            '<td>'+ data[i].fields.num_ficha +'</td>'+
                                                                                            '<td>'+ data[i].fields.fecha_ficha +'</td>'+
                                                                                            '<td>'+ data[i].fields.ambiente +'</td>'+
                                                                                            '<td>'+ data[i].fields.piso +'</td>'+
                                                                                            '<td>'+ data[i].fields.dependencia +'</td>'+
                                                                                            '<td>'+ data[i].fields.sede+'</td>'+
                                                                                            
                                                                                            '<td><button onclick="editFicha('+String(data[i].fields.num_ficha)+')" id="editar" class="btn btn-success"  >Editar</button></td>'+
                                                                                            '<td><a href="#" class="btn btn-danger" >Eliminar</a></td>'+
                                                                                        '</tr>'+
                                                                                    '</tbody>'
                                                                                }
                                                                                $('#fichas').html(html)
                                                                            });
                                                                        })

                                                                        

                                                                        $('#editar').on('click', function(){
                                                                            console.log("Hola")
                                                                        })

                                                                        })

                                                                      
                                                                </script-->
                                                        </div>
                                                 
                                                    <tbody>
                                            
                                                   
                                                    </tbody>
                                                </table>
                                                

                                            </div>
                                        </div>
                                    </div>
    
      
                                </div>


                        </div>

                        <div class="app-main__inner">
          
              

                                <div class="row">
                                    
                                        <div class="col-lg-12" >
                                            <div class="main-card mb-3 card" style="margin-top: -120px;">
                                                <div class="card-body"><h5 class="card-title">Ficha</h5>
                                                   
    
                                                    <table class="mb-0 table table-bordered" id="fichas">
                                                          
            
                                                         
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
        
          
                                    </div>
    
    
                            </div>
                         
    </div>
</div>

{% endblock %}  